[{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 tessireport authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sky Syzygy. Author, maintainer.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Syzygy S (2024). tessireport: Data hygiene tools Tessitura. R package version 0.0.0.9000, https://github.com/skysyzygy/tessireport.","code":"@Manual{,   title = {tessireport: Data hygiene tools for Tessitura},   author = {Sky Syzygy},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://github.com/skysyzygy/tessireport}, }"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/index.html","id":null,"dir":"","previous_headings":"","what":"Data hygiene tools for Tessitura","title":"Data hygiene tools for Tessitura","text":"tessireport set scripts data hygiene Tessitura, using data queried cached tessilake processed tessistream.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Data hygiene tools for Tessitura","text":"can install latest version GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"skysyzygy/tessireport\")"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Data hygiene tools for Tessitura","text":"run simple SQL report…","code":"library(tessireport)  run(sql_report, query = \"select * from my_table\",     subject = \"This is my table\",     emails = \"me@me.com\")"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/duplicates_report.html","id":null,"dir":"Reference","previous_headings":"","what":"duplicates_report — duplicates_report","title":"duplicates_report — duplicates_report","text":"Sends email containing spreadsheet duplicates review","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/duplicates_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"duplicates_report — duplicates_report","text":"","code":"# S3 method for duplicates_report read(duplicates_report, ...)  # S3 method for duplicates_report output(duplicates_report, routing = NULL, ...)"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/duplicates_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"duplicates_report — duplicates_report","text":"duplicates_report duplicates_report object ... Arguments passed send_xlsx body Body email text. parameter body refers existing file location, text file parsed body email. routing named list, names email addresses values vectors customer numbers. duplicate pair contains matching customer number emailed named email address.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/duplicates_report.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"duplicates_report — duplicates_report","text":"read(duplicates_report): read duplicates data output tessistream::duplicates_stream output(duplicates_report): segments duplicates data based map provided routing emails excel spreadsheets using send_xlsx","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/make_unsubscribe_report_fixtures.html","id":null,"dir":"Reference","previous_headings":"","what":"make_unsubscribe_report_fixtures — make_unsubscribe_report_fixtures","title":"make_unsubscribe_report_fixtures — make_unsubscribe_report_fixtures","text":"Make fixtures unsubscribe_report testing","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/make_unsubscribe_report_fixtures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make_unsubscribe_report_fixtures — make_unsubscribe_report_fixtures","text":"","code":"make_unsubscribe_report_fixtures()"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/p2_orphans_report.html","id":null,"dir":"Reference","previous_headings":"","what":"p2_orphans_report — p2_orphans_report","title":"p2_orphans_report — p2_orphans_report","text":"Sends email containing plot recent orphans spreadsheet orphans.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/p2_orphans_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"p2_orphans_report — p2_orphans_report","text":"","code":"# S3 method for p2_orphans_report run(p2_orphans_report, freshness = 0, ...)"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/p2_orphans_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"p2_orphans_report — p2_orphans_report","text":"p2_orphans_report p2_orphans_report object freshness returned data least fresh ... used","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/report.html","id":null,"dir":"Reference","previous_headings":"","what":"report — report","title":"report — report","text":"Base S3 class report.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"report — report","text":"","code":"report(x = list(), class = character())  is_report(x)  read(...)  # S3 method for report read(x, ...)  process(...)  # S3 method for report process(x, ...)  # S3 method for report print(x, ...)  output(...)  # S3 method for report output(x, ...)  write(...)  # S3 method for report write(x, ...)  run(...)  # S3 method for report run(x, ...)"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"report — report","text":"x list class optional additional subclass ... additional parameters subclassed methods","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/report.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"report — report","text":"read(report): thing print warning, intended overloaded subclass process(report): thing print warning, intended overloaded subclass print(report): prints names contents report object output(report): thing print warning, intended overloaded subclass write(report): thing print warning, intended overloaded subclass run(report): run methods order: read -> process -> output -> write","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/report.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"report — report","text":"is_report(): tests x report object read(): generic function dispatch data reading process(): generic function dispatch data processing output(): generic fucntion dispatch data output write(): generic function dispatch data saving run(): generic function dispatch report running","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_email.html","id":null,"dir":"Reference","previous_headings":"","what":"send_email — send_email","title":"send_email — send_email","text":"send_email","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_email.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"send_email — send_email","text":"","code":"send_email(   subject,   body,   emails = config::get(\"tessiflow.email\"),   smtp = config::get(\"tessiflow.smtp\"),   ... )"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_email.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"send_email — send_email","text":"subject Subject email. body Body email text. parameter body refers existing file location, text file parsed body email. emails email addresses (first sender) smtp list configuration parameters establish authorize connection SMTP server. See details various parameters. ... Arguments passed mailR::send.mail html boolean indicating whether body email parsed HTML. attach.files character vector paths file system linking files *valid* URLs attached email (see details info attaching URLs)","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_unsubscribe_report_table.html","id":null,"dir":"Reference","previous_headings":"","what":"send_unsubscribe_report_table — send_unsubscribe_report_table","title":"send_unsubscribe_report_table — send_unsubscribe_report_table","text":"Simple wrapper send_xlsx","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_unsubscribe_report_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"send_unsubscribe_report_table — send_unsubscribe_report_table","text":"","code":"send_unsubscribe_report_table(table, email)"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_unsubscribe_report_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"send_unsubscribe_report_table — send_unsubscribe_report_table","text":"table data.table send email character email address send email ","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_xlsx.html","id":null,"dir":"Reference","previous_headings":"","what":"send_xlsx — send_xlsx","title":"send_xlsx — send_xlsx","text":"Simple wrapper send_email write_xlsx","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_xlsx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"send_xlsx — send_xlsx","text":"","code":"send_xlsx(   table,   subject = paste(format(substitute(table)), Sys.Date()),   body = paste(\"Sent by\", Sys.info()[\"nodename\"]),   emails = config::get(\"tessiflow.email\"),   ... )"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/send_xlsx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"send_xlsx — send_xlsx","text":"table data.table send subject Subject email. body Body email text. parameter body refers existing file location, text file parsed body email. emails email addresses (first sender) ... Arguments passed mailR::send.mail, write_xlsx html boolean indicating whether body email parsed HTML. inline boolean indicating whether images HTML file embedded inline. group character name column used grouping/banding data. Band color change column value changes. currency character vector column used grouping/banding data. Band color change column value changes.","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/sql_report.html","id":null,"dir":"Reference","previous_headings":"","what":"sql_report — sql_report","title":"sql_report — sql_report","text":"Report wraps functionality tessilake::read_sql send_xlsx","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/sql_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sql_report — sql_report","text":"","code":"# S3 method for sql_report run(sql_report, ...)  # S3 method for sql_report read(sql_report, query, ...)  # S3 method for sql_report output(sql_report, query, ...)"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/sql_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sql_report — sql_report","text":"sql_report sql_report object ... Arguments passed tessilake::read_sql, send_xlsx, write_xlsx, mailR::send.mail primary_keys character vector, primary keys table. read_sql_table attempt identify primary keys using SQL metadata. freshness returned data least fresh emails email addresses (first sender) subject Subject email. body Body email text. parameter body refers existing file location, text file parsed body email. group character name column used grouping/banding data. Band color change column value changes. currency character vector column used grouping/banding data. Band color change column value changes. html boolean indicating whether body email parsed HTML. inline boolean indicating whether images HTML file embedded inline. query character sql query generate report","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/sql_report.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"sql_report — sql_report","text":"read(sql_report): reads sql_report data output(sql_report): sends sql_report data","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/sql_report.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sql_report — sql_report","text":"","code":"if (FALSE) {  run(sql_report,       query = \"select * from my_table\",       subject = \"Email subject\",       body = \"Email body\",       emails = \"me@me.com\"  ) }"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/tessireport-package.html","id":null,"dir":"Reference","previous_headings":"","what":"tessireport: Data hygiene tools for Tessitura — tessireport-package","title":"tessireport: Data hygiene tools for Tessitura — tessireport-package","text":"tessireport set scripts data hygiene Tessitura, using data queried cached tessilake processed tessistream.","code":""},{"path":[]},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/tessireport-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tessireport: Data hygiene tools for Tessitura — tessireport-package","text":"Maintainer: Sky Syzygy sky@skysyzygy.xyz (ORCID)","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":null,"dir":"Reference","previous_headings":"","what":"unsubscribe_report — unsubscribe_report","title":"unsubscribe_report — unsubscribe_report","text":"Reports unsubscribes bad addresses group customers","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"unsubscribe_report — unsubscribe_report","text":"","code":"# S3 method for unsubscribe_report run(unsubscribe_report, ...)  # S3 method for unsubscribe_report read(unsubscribe_report, customers, ...)  # S3 method for unsubscribe_report process(unsubscribe_report, ...)  # S3 method for unsubscribe_report output(   unsubscribe_report,   since = Sys.Date() - 30,   until = Sys.Date() + 30,   routing_rules = list(TRUE ~ list(config::get(\"tessiflow.email\"))),   ... )"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"unsubscribe_report — unsubscribe_report","text":"unsubscribe_report unsubscribe_report object ... used customers integer vector customer numbers load since date, start date filtering returned data date, end date filtering returned data routing_rules list formulas used routing, dplyr::case_when. Can refer columns returned process.unsubscribe_report. See Note ","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"unsubscribe_report — unsubscribe_report","text":"read(unsubscribe_report): reads unsubscribe_report data Loads data p2: unsubscribes hard bounces list (uses p2_stream_enriched tessistream) tessi: emails, addresses, logins, memberships, constituencies, MGOs (attributes) process(unsubscribe_report): process unsubscribe_report data Checks emails unsubscribed, bounced, exist Checks mailing addresses NCOA flag exist Checks customer primary login match primary email Checks customers inactive Adds identifying info: MGO, constituencies, membership expiration date level output(unsubscribe_report): send unsubscribe_report emails MGOs Data filtered events since returned events members expiration dates since returned","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"unsubscribe_report — unsubscribe_report","text":"example, value routing_rules:   Routes based following rules: GOV -> send Government Affairs (eleszynski) CP# -> send Strategic Partnerships (lmcgee) ??+ -> send Patron Program (apratama jhindle) -> send Dev Ops (kburke esearles)","code":"list(grepl(\"GOV\", constituencies) ~ list(\"eleszynski@bam.org\"),      grepl(\"CP\\\\d\", constituencies) ~ list(\"lmcgee@bam.org\"),      grepl(\"\\\\+\",constituencies) ~ list(c(\"apratama@bam.org\",\"jhindle@bam.org\")),      TRUE ~ list(c(\"kburke@bam.org\",\"esearles@bam.org\")))"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/unsubscribe_report.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"unsubscribe_report — unsubscribe_report","text":"","code":"if (FALSE) { run(unsubscribe_report,     customers = c(1,2,3),     routing_rules = list(grepl(\"GOV\", constituencies) ~ list(\"eleszynski@bam.org\"),                          grepl(\"CP\\\\d\", constituencies) ~ list(\"lmcgee@bam.org\"),                          grepl(\"\\\\+\",constituencies) ~ list(c(\"apratama@bam.org\",\"jhindle@bam.org\")),                          TRUE ~ list(c(\"kburke@bam.org\",\"esearles@bam.org\")))) }"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/write_xlsx.html","id":null,"dir":"Reference","previous_headings":"","what":"write_xlsx — write_xlsx","title":"write_xlsx — write_xlsx","text":"Convenience wrapper around openxlsx::write.xlsx handle common formatting tasks: Column headers title-cased bolded Column widths calculated based string representations data Date columns formatted DATE instead LONGDATE optional additions: Band columns group Specify currency columns","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/write_xlsx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"write_xlsx — write_xlsx","text":"","code":"write_xlsx(   data,   filename = tempfile(\"write_xlsx\", fileext = \".xlsx\"),   group = NULL,   currency = NULL,   overwrite = FALSE,   ... )"},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/write_xlsx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"write_xlsx — write_xlsx","text":"data data write spreadsheet filename filename write group character name column used grouping/banding data. Band color change column value changes. currency character vector column used grouping/banding data. Band color change column value changes. overwrite TRUE, overwrite existing file. ... used","code":""},{"path":"https://bamorg-my.sharepoint.com/personal/ssyzygy_bam_org/Documents/documentation/tessireport/reference/write_xlsx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"write_xlsx — write_xlsx","text":"filename written xlsx","code":""}]
